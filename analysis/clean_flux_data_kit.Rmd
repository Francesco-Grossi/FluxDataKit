---
title: "Data cleaning"
author: "Beni"
date: "3/16/2022"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
```

## Load data


```{r cars}
df <- readRDS("~/Downloads/site_based_drivers_HH.rds") %>% 
  as_tibble() %>% 
  group_by(sitename) %>% 
  nest()
```

## Outliers

```{r pressure, echo=FALSE}
detect_outliers_gpp <- function(df){
  
  outliers <- boxplot.stats(df$GPP_NT_VUT_REF)$out
  out_sd <- sd(outliers)
  ...
  
  ## add new column to df
  df$outlier_res <- res/res_sd
  
  return(df)
}

## read https://stineb.github.io/esds_book/ch-02.html#functional-programming-i
df_clean <- df %>% 
  mutate(data = purrr::map(data, ~detect_outliers_gpp(.)))
  
```

## spurious ...
